###  1. 흡연 여부(smoking)로 구분한 각 그룹의 컬렴명과 그룹의 사람의 수를 출력하시오.

```sql 
SELECT smoking, COUNT(*) FROM healthcare where smoking != '' GROUP BY smoking;

smoking  COUNT(*)
-------  --------
1        626138
2        189808
3        183711
```

###  2. 음주 여부(is_drinking)로 구분한 각 그룹의 컬렴명과 그룹의 사람의 수를 출력하시오.

```sql 
SELECT is_drinking, COUNT(*) FROM healthcare where is_drinking != '' GROUP BY is_drinking;

is_drinking  COUNT(*)
-----------  --------
0            415119
1            584685
```

### 3. 음주 여부로 구분한 각 그룹에서 혈압(blood_pressure)이 200이상인 사람의 수를 출력하시오.

```sql
SELECT is_drinking, COUNT(*) from healthcare WHERE blood_pressure >= 200 GROUP BY is_drinking;

is_drinking  COUNT(*)
-----------  --------
0            6064
1            1770
```

### 4. 시도(sido)에 사는 사람의 수가 50000명 이상인 시도의 코드와 그 시도에 사는 사람의 수를 출력하시오.

```sql
SELECT sido, COUNT(*) FROM healthcare GROUP BY sido HAVING COUNT(sido) >= 50000;

sido  COUNT(*)
----  --------
11    166231
26    69025
28    58345
41    247369
47    54438
48    68530

```

### 5. 키(height)를 기준으로 구분하고, 각 키와 사람의 수를 출력하시오.

> 단, 사람의 수를 기준으로 내림차순으로 5개까지 출력하시오.

```sql
SELECT height, COUNT(*) FROM healthcare GROUP BY height ORDER BY count(height) DESC LIMIT 5; 

height  COUNT(*)
------  --------
160     184993
155     181306
165     179352
170     152585
150     128555

```

### 6. 키(height)와 몸무게(weight)를 기준으로 구분하고, 몸무게와, 키, 해당 그룹의 사람의 수를 출력하시오. 

> 단, 사람의 수를 기준으로 내림차순 5개까지 출력하시오.

```sql
SELECT weight, height, COUNT(*) FROM healthcare GROUP BY height, weight ORDER BY COUNT(*) DESC LIMIT 5;

weight  height  COUNT(*)
------  ------  --------
55      155     45866
60      160     42454
65      165     40385
50      155     38582
55      160     38066

```

### 7. 음주여부에 따라 평균 허리둘레(waist)와 사람의 수를 출력하시오.

```sql 
SELECT is_drinking, AVG(waist), COUNT(*) from healthcare WHERE is_drinking != '' GROUP BY is_drinking;

is_drinking  AVG(waist)        COUNT(*)
-----------  ----------------  --------
0            81.2128249971711  415119
1            83.1541594191841  584685

SELECT is_drinking, AVG(waist), COUNT(*) from healthcare GROUP BY is_drinking HAVING is_drinking != '';

is_drinking  AVG(waist)        COUNT(*)
-----------  ----------------  --------
0            81.2128249971711  415119
1            83.1541594191841  584685

둘의 차이는 전자는 SELECT에서 공백이 아닌 음주 여부 확인 가능자를 보여주는 것이고, 후자는 그룹화를 해놓은 상태에서 그룹화 테이블에서 공백이 아닌 음주 여부 확인 가능자를 보여주는 것입니다.
또한 GROUP BY를 사용할 때 꼭 집계함수를 써야 하는 것은 아닙니다. GROUP BY의 기준이 되는 것은 집계함수를 쓰지 않아도 됩니다. 
당장 코드에서는 같은 역할을 하는 것과 같습니다만 사실 HAVING은 GROUP BY를 사용해야 사용 가능한 조건문입니다. 따라서 항상 WHERE와 HAVING이 같은 역할을 하는 것은 아닙니다. WHERE는 FROM에서 가져온 값을 필터링하고 HAVING은 GROUP BY 이후의 값을 필터링합니다. 
```

### 8. 각 성별(gender)의 평균 왼쪽 시력(va_left)과 평균 오른쪽 시력(va_right)를 출력하시오.

> 단, 평균 왼쪽 시력과 평균 오른쪽 시력의 컬럼명을 '평균 왼쪽 시력' '평균 오른쪽 시력'로 표시하고, 평균 시력은 소수점 둘째 자리까지 출력하시오.

```sql
SELECT gender, ROUND(AVG(va_left),2) AS '평균 왼쪽 시력', ROUND(AVG(va_right),2) AS '평균 오른쪽 시력' FROM healthcare GROUP BY gender;

gender  평균 왼쪽 시력  평균 오른쪽 시력
------  --------  ---------
1       0.98      0.99
2       0.88      0.88

```

### 9. 각 나이대(age)의 평균 키와 평균 몸무게를 출력하시오.

> 단, 평균 키와 평균 몸무게의 컬럼명을 '평균 키' '평균 몸무게'로 표시하고, 평균키가 160 이상 평균 몸무게가 60 이상인 데이터만 출력하시오.

```sql
SELECT age, AVG(height) '평균 키', AVG(weight) '평균 몸무게' FROM healthcare GROUP BY age HAVING AVG(height) >= 160 AND AVG(weight) >= 60;

age  평균 키              평균 몸무게
---  ----------------  ----------------
9    165.66545300972   67.2402208898302
10   164.119689244962  65.677140776194
11   162.111550610398  63.9036737713782
12   160.653006214415  62.5955563062588

SELECT age, AVG(height) '평균 키', AVG(weight) '평균 몸무게' FROM healthcare GROUP BY age HAVING '평균 키' >= 160 AND '평균 몸무게' >= 60;

age  평균 키              평균 몸무게
---  ----------------  ----------------
9    165.66545300972   67.2402208898302
10   164.119689244962  65.677140776194
11   162.111550610398  63.9036737713782
12   160.653006214415  62.5955563062588
13   159.12821736215   61.5041974003198
14   157.81034701626   60.7892975430741
15   156.577040996283  59.7307838402474
16   154.966042058751  58.0255298257098
17   153.267381735823  55.8414170334601
18   150.440115440115  51.0261343594677

-->작은 따옴표 때신 큰 따옴표 "" 로 별칭을 패킹해보세요.

SELECT age, AVG(height) '평균 키', AVG(weight) '평균 몸무게' FROM healthcare GROUP BY age HAVING "평균 키" >= 160 AND "평균 몸무게" >= 60;

age  평균 키              평균 몸무게
---  ----------------  ----------------
9    165.66545300972   67.2402208898302
10   164.119689244962  65.677140776194
11   162.111550610398  63.9036737713782
12   160.653006214415  62.5955563062588

```

### 10. 음주 여부(is_drinking)와 흡연 여부(smoking)에 따른 평균 BMI를 출력하시오.

> 단, 음주 여부 또는 흡연 여부가 공백이 아닌 행만 사용하세요.

```sql
SELECT is_drinking, smoking, AVG(weight*10000/(height*height)) AS '평균 BMI' from healthcare WHERE is_drinking != '' and smoking != '' GROUP BY is_drinking, smoking;

is_drinking  smoking  평균 BMI
-----------  -------  ----------------
0            1        23.3567730674792
0            2        24.101591663804
0            3        23.8207750914872
1            1        23.4170949193033
1            2        24.5228781429217
1            3        24.1333191452571

```
### 11. 각 나이대의 평균 허리둘레(waist)와 사람의 수를 출력하시오.

``` sql
SELECT age, AVG(waist), COUNT(*) from healthcare GROUP BY age; 

age  AVG(waist)        COUNT(*)
---  ----------------  --------
9    81.6633938455401  156277
10   81.3983366281667  144165
11   81.4732113485653  175705
12   81.96502403423    142089
13   82.6719986331032  155096
14   83.7589131363025  86653
15   84.3597715495021  73714
16   84.6731445871866  36663
17   84.41396094184    23401
18   81.9982523649192  6237

```



### 12. 각 성별(gender), 연령별대의 평균 BMI 과 평균 혈압을 출력하시오.

```sql
SELECT gender, age, AVG(weight/(0.0001 * height * height)) "평균 BMI", AVG(blood_pressure) "평균 혈압" from healthcare GROUP BY gender, age;

gender  age  평균 BMI            평균 혈압
------  ---  ----------------  ----------------
1       9    25.5398149617387  124.39618929157
1       10   25.1985516113171  124.878180464975
1       11   24.9688132856661  125.247149312135
1       12   24.6666095239465  126.391971598692
1       13   24.5092902594933  127.467656486809
1       14   24.3866556022996  126.302872493343
1       15   24.162576353021   126.754358251058
1       16   23.8039642284613  127.537946821624
1       17   23.3882637434418  127.047829004122
1       18   22.6139585646315  125.915021459227
2       9    22.7680247407751  115.957165177913
2       10   23.0838580449306  118.438975528571
2       11   23.4107189615795  120.760183087521
2       12   23.649041642502   122.692570488922
2       13   23.9414498788618  125.155742081279
2       14   24.3194400777149  124.917654242808
2       15   24.4641076684514  125.642457662555
2       16   24.3883665689417  125.832416182615
2       17   23.9815459295865  125.166718075262
2       18   22.367394126239   120.31635525979
```



### 13. 흡연여부에 따라 평균 허리둘레(waist)와 사람의 수를 출력하시오.

```sql
SELECT smoking, AVG(waist), count(*) from healthcare WHERE smoking <> '' GROUP BY smoking; 

smoking  AVG(waist)        count(*)
-------  ----------------  --------
1        80.2875519454265  626138
2        86.3224105411754  189808
3        85.2661811214319  183711
```

